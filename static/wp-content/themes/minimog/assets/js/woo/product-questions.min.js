!function(u){"use strict";var r=window.minimog.Helpers;u(document).ready(function(){var s,d,m,e,t,n,o;e=u("#minimog-wc-question"),s=u(".woocommerce-noreviews",e),d=u(".question-list-container",e),m=u(".question-list",e),u(document.body).on("submit",".question-form",function(e){e.preventDefault();var n=u(this),t=n.find('button[type="submit"]'),o=u("[name=question]",n),i=parseInt(u("input[name=question_parent_id]",n).val()),a=parseInt(u(".question-count",d).html());u.ajax({url:$minimog.ajaxurl,type:"POST",cache:!1,dataType:"json",data:n.serialize(),success:function(e){var t;(e.success?(i?((t=u(".children","#li-comment-"+i)).length?t.prepend(e.data.response):(t=u('<ol class="children" />')).appendTo("#li-comment-"+i).html(e.data.response),u(document.body).trigger("minimog_product_question_child_added",[i])):(a+=1,s.length&&s.remove(),m.prepend(e.data.response)),t=1===a?e.data.single_text:e.data.plural_text,u(".question-count",d).html(a),u(".question-text",d).html(t),o.val(""),u(document.body).trigger("minimog_product_question_added",[e.data,!0]),n.find(".question-form-message-box").addClass("success")):n.find(".question-form-message-box").addClass("failed")).text(e.data.message).slideDown()},beforeSend:function(){n.find(".question-form-message-box").text("").removeClass("failed success").slideUp(),r.setElementHandling(t)},complete:function(){r.unsetElementHandling(t)}})}),u(document.body).on("click",".question-reply",function(e){e.preventDefault();var e=u(this),t=e.data("question-id"),n=u("#modal-product-question"),o=n.find(".modal-title"),i=n.find(".question-form-message-box"),a=n.find('input[name="question_parent_id"]'),e=e.closest(".comment-footer").siblings(".meta").children(".fn").text(),s=n.data("reply-title");i.removeClass("success failed").text(""),s=s.replace("{comment_author_name}",e),o.text(s),n.MinimogModal("open"),a.val(t)}),e=u("#minimog-wc-question"),t=e.closest(".minimog-tabs"),n=u(".question-search-form",e),o=u(".question-toolbar",e),n.on("submit",function(e){return e.preventDefault(),u.ajax({url:$minimog.ajaxurl,type:"GET",data:n.serialize(),dataType:"json",cache:!0,success:function(e){e.data.fragments&&(u.each(e.data.fragments,function(e,t){u(e).empty(),""!==t&&(t=u.trim(t),t=u(u.parseHTML(t)),u(e).html(t.html()))}),0<t.length&&t.MinimogTabPanel("updateLayout"),u(document.body).trigger("minimog_get_product_questions_fragments_loaded"))},beforeSend:function(){r.setBodyHandling();var e=0,t=o.offset().top;t-=e=u(document.body).hasClass("header-sticky-enable")?u("#page-header").outerHeight():e,u("html, body").animate({scrollTop:t},800)},complete:function(){r.setBodyCompleted()}}),!1}),u(document.body).on("click",".question-navigation a",function(e){e.preventDefault();e=r.getUrlParamsAsObject(u(this).attr("href")),e=e?e.current_page:1;n.find('input[name="current_page"]').val(e),n.trigger("submit")}),u(document.body).on("minimog_product_question_added",function(){var e=u("#minimog-wc-question");0<e.length&&0<(e=e.closest(".minimog-tabs")).length&&e.MinimogTabPanel("updateLayout")})})}(jQuery);